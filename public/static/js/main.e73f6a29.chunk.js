(this["webpackJsonpreact-rails-api-project-template-client"]=this["webpackJsonpreact-rails-api-project-template-client"]||[]).push([[0],{38:function(e,t,a){},39:function(e,t,a){},41:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(33),r=a.n(o),i=(a(38),a(8)),s=a(4),l=(a(39),a(2)),j=function(){return Object(l.jsxs)("nav",{className:"navbar",children:[Object(l.jsx)(i.c,{to:"/",className:"nav-link",activeclassname:"active",children:"Home"}),Object(l.jsx)(i.c,{to:"/profile",className:"nav-link",activeclassname:"active",children:"Profile"}),Object(l.jsx)(i.c,{to:"/library",className:"nav-link",activeclassname:"active",children:"Library"}),Object(l.jsx)(i.c,{to:"/books/upload",className:"nav-link",activeclassname:"active",children:"Upload Book"})]})},u=a(5),b=a(55),d=a.p+"static/media/library.3eaf9e8f.jpg",h=a.p+"static/media/logo.43924e38.png";a(41);var p=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),r=Object(u.a)(o,2),j=r[0],p=r[1],m=Object(n.useState)(""),O=Object(u.a)(m,2),f=O[0],g=O[1],x=Object(s.o)(),v=function(e){var t=e.target,a=t.name,n=t.value;"username"===a?c(n):"password"===a&&p(n)};return Object(l.jsx)("div",{className:"login-container",style:{backgroundImage:"url(".concat(d,")")},children:Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),b.a.post("http://localhost:3000/login",{username:a,password:j},{withCredentials:!0}).then((function(e){e.data.jwt?(localStorage.setItem("token",e.data.jwt),localStorage.setItem("username",a),x("/library")):g("Invalid username or password")})).catch((function(e){console.log("login error",e)}))},className:"login-form",children:[Object(l.jsx)("img",{src:h,alt:"Logo",className:"logo"}),Object(l.jsx)("input",{type:"text",name:"username",placeholder:"Username",value:a,onChange:v,required:!0}),Object(l.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:j,onChange:v,required:!0}),Object(l.jsx)("button",{type:"submit",className:"login-button",children:"Login"}),f&&Object(l.jsx)("p",{className:"error-message",children:f}),Object(l.jsx)(i.b,{to:"/signup",className:"login-button",children:"Sign up"})]})})};a(46);var m=function(e){var t=e.setIsLoggedIn,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],r=c[1],s=Object(n.useState)(""),j=Object(u.a)(s,2),d=j[0],p=j[1],m=Object(n.useState)(""),O=Object(u.a)(m,2),f=O[0],g=O[1],x=Object(n.useState)(""),v=Object(u.a)(x,2),N=v[0],y=v[1],k=function(e){var t=e.target,a=t.name,n=t.value;"username"===a?r(n):"password"===a?g(n):"email"===a&&p(n)};return Object(l.jsxs)("div",{className:"signup-container",children:[Object(l.jsx)("header",{children:Object(l.jsx)("img",{src:h,alt:"Logo",className:"logo"})}),Object(l.jsx)("div",{className:"signup-form-container",children:Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),b.a.post("http://localhost:3000/users",{username:o,email:d,password:f},{withCredentials:!0}).then((function(e){e.data.jwt?(localStorage.setItem("token",e.data.jwt),t(!0)):y("Failed to create account")})).catch((function(e){console.log("sign up error",e)}))},className:"signup-form",children:[Object(l.jsx)("input",{type:"text",name:"username",placeholder:"Username",value:o,onChange:k,required:!0}),Object(l.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:d,onChange:k,required:!0}),Object(l.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:f,onChange:k,required:!0}),Object(l.jsx)("button",{type:"submit",className:"signup-button",children:"Sign Up"}),N&&Object(l.jsx)("p",{className:"error-message",children:N}),Object(l.jsx)(i.b,{to:"/login",className:"login-link",children:"Already have an account? Log in"})]})})]})},O=(a(47),function(e){var t=e.book,a=e.onPurchase,n=t.title,c=t.author,o=t.image_url,r=t.description,i=t.price,s=r.split(" ").slice(0,5).join(" ");return Object(l.jsxs)("div",{className:"book",children:[Object(l.jsx)("h2",{children:n}),Object(l.jsx)("p",{children:c}),o&&Object(l.jsx)("img",{src:o,alt:n,className:"book-image"}),Object(l.jsx)("p",{children:s}),Object(l.jsx)("p",{children:i}),Object(l.jsx)("button",{onClick:a,children:"Buy"})]})}),f=(a(48),b.a.create({baseURL:"http://localhost:3000",headers:{Accept:"application/json","Content-Type":"application/json"}}));f.defaults.headers.common.Authorization="Bearer [put the token here]";var g=f,x=function(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(1),r=Object(u.a)(o,2),i=r[0],j=r[1],b=Object(n.useState)(""),d=Object(u.a)(b,2),p=d[0],m=d[1],f=Object(s.o)(),x=Object(n.useCallback)((function(){var e=localStorage.getItem("token");if(e&&"null"!==e)return e;f("/login")}),[f]),v=Object(n.useCallback)((function(e){g.get("http://localhost:3000/books",{headers:{Accept:"application/json",Authorization:"Bearer ".concat(x())}}).then((function(e){c(e.data)})).catch((function(e){console.log("book fetch error",e)}))}),[x]);Object(n.useEffect)((function(){var e=localStorage.getItem("username");m(e),v(i)}),[i,v]);var N=function(e,t){var a=e.split(" ");return a.length>t?a.slice(0,t).join(" ")+"...":e};return Object(l.jsxs)("div",{className:"library-container",children:[Object(l.jsxs)("header",{children:[Object(l.jsx)("img",{src:h,alt:"Logo",className:"logo"}),Object(l.jsx)("div",{className:"user-details",children:p})]}),Object(l.jsx)("div",{className:"books-grid",children:a.map((function(e){return Object(l.jsx)(O,{book:e,onPurchase:function(){return t=e.id,a=e.price,void g.post("http://localhost:3000/transactions",{book_id:t,transaction:{amount:100*a}},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x())}}).then((function(e){var t=e.data.confirmationCode;console.log("Transaction confirmed with code:",t),alert("Thank you for purchasing this book. Please wait as we process your payment.")})).catch((function(e){console.log("Transaction failed:",e)}));var t,a},truncatedDescription:N(e.description,13)},e.id)}))}),Object(l.jsxs)("div",{className:"pagination-buttons",children:[Object(l.jsx)("button",{onClick:function(){i>1&&j((function(e){return e-1}))},disabled:1===i,children:"Previous"}),Object(l.jsx)("button",{onClick:function(){j((function(e){return e+1}))},children:"Next"})]})]})},v=(a(49),function(){var e=localStorage.getItem("token");if(e&&"null"!==e)return e}),N=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),r=Object(u.a)(o,2),i=r[0],s=r[1],j=Object(n.useState)(""),d=Object(u.a)(j,2),p=d[0],m=d[1],O=Object(n.useState)(""),f=Object(u.a)(O,2),g=f[0],x=f[1];return Object(l.jsxs)("div",{className:"upload-book-container",children:[Object(l.jsx)("header",{children:Object(l.jsx)("img",{src:h,alt:"Logo",className:"logo"})}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={title:a,author:i,description:p,image:g};b.a.post("http://localhost:3000/books/upload",t,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v())}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},className:"upload-book-form",children:[Object(l.jsx)("input",{type:"text",placeholder:"Title",value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(l.jsx)("input",{type:"text",placeholder:"Author",value:i,onChange:function(e){return s(e.target.value)},required:!0}),Object(l.jsx)("textarea",{placeholder:"Description",value:p,onChange:function(e){return m(e.target.value)},required:!0}),Object(l.jsx)("input",{type:"url",placeholder:"Image URL",value:g,onChange:function(e){return x(e.target.value)},required:!0}),Object(l.jsx)("button",{type:"submit",children:"Upload"})]})]})},y=a(7),k=a(29),C=(a(50),function(){var e=Object(s.o)(),t=Object(n.useState)(!0),a=Object(u.a)(t,2),c=a[0],o=a[1],r=Object(n.useState)({name:"",email:"",bio:"",address:"",image:"",contacts:""}),i=Object(u.a)(r,2),j=i[0],b=i[1],d=function(){var e=localStorage.getItem("token");if(e&&"null"!==e)return e};Object(n.useEffect)((function(){fetch("http://localhost:3000/profiles",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(d())}}).then((function(e){return e.json()})).then((function(e){b(e),o(!1)})).catch((function(e){console.error("Error fetching user profile:",e),o(!1)}))}),[]);var p=function(e){b(Object(k.a)(Object(k.a)({},j),{},Object(y.a)({},e.target.name,e.target.value)))};return c?Object(l.jsx)("div",{children:"Loading..."}):Object(l.jsxs)("div",{className:"profile-container",children:[Object(l.jsx)("header",{children:Object(l.jsx)("img",{src:h,alt:"Logo",className:"logo"})}),Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault();var a=Object(k.a)({},j);fetch("http://localhost:3000/profiles",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(d())},body:JSON.stringify(a)}).then((function(e){if(e.ok)return e.json();throw new Error("Failed to create profile")})).then((function(t){b(t),console.log(t),window.alert("Profile Created Successfully"),e("/profile/".concat(t.id))})).catch((function(e){console.error("Error creating user profile:",e),window.alert("Create failed. One of the fields was invalid. Please try again")}))},className:"profile-form",children:[Object(l.jsx)("h1",{children:"Profile"}),Object(l.jsxs)("div",{className:"form-input-group",children:[Object(l.jsx)("label",{htmlFor:"name",children:"Name:"}),Object(l.jsx)("input",{type:"text",id:"name",name:"name",value:j.name,onChange:p,required:!0})]}),Object(l.jsxs)("div",{className:"form-input-group",children:[Object(l.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(l.jsx)("input",{type:"email",id:"email",name:"email",value:j.email,onChange:p,required:!0})]}),Object(l.jsxs)("div",{className:"form-input-group",children:[Object(l.jsx)("label",{htmlFor:"bio",children:"Bio:"}),Object(l.jsx)("input",{type:"text",id:"bio",name:"bio",value:j.bio,onChange:p,required:!0})]}),Object(l.jsxs)("div",{className:"form-input-group",children:[Object(l.jsx)("label",{htmlFor:"address",children:"Address:"}),Object(l.jsx)("input",{type:"text",id:"address",name:"address",value:j.address,onChange:p,required:!0})]}),Object(l.jsxs)("div",{className:"form-input-group",children:[Object(l.jsx)("label",{htmlFor:"image",children:"Avatar:"}),Object(l.jsx)("input",{type:"text",id:"image",name:"image",value:j.image,onChange:p,required:!0})]}),Object(l.jsxs)("div",{className:"form-input-group",children:[Object(l.jsx)("label",{htmlFor:"contacts",children:"Contacts:"}),Object(l.jsx)("input",{type:"number",id:"contacts",name:"contacts",value:j.contacts,onChange:p,required:!0})]}),Object(l.jsx)("button",{type:"submit",children:"Create Profile"})]})]})}),S=(a(51),function(){var e=Object(s.q)().id,t=Object(n.useState)(!0),a=Object(u.a)(t,2),c=a[0],o=a[1],r=Object(n.useState)(null),j=Object(u.a)(r,2),b=j[0],d=j[1],h=function(){var e=localStorage.getItem("token");if(e&&"null"!==e)return e};return Object(n.useEffect)((function(){fetch("http://localhost:3000/profiles/".concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h())}}).then((function(e){return e.json()})).then((function(e){d(e),o(!1)})).catch((function(e){console.error("Error fetching profile details:",e),o(!1)}))}),[e]),c?Object(l.jsx)("div",{children:"Loading..."}):b?Object(l.jsx)("div",{className:"profile-details-container",children:Object(l.jsxs)("form",{className:"profile-details-form",children:[Object(l.jsx)("h1",{children:"Profile Details"}),Object(l.jsxs)("p",{children:["Name: ",b.name]}),Object(l.jsxs)("p",{children:["Email: ",b.email]}),Object(l.jsxs)("p",{children:["Bio: ",b.bio]}),Object(l.jsxs)("p",{children:["Address: ",b.address]}),Object(l.jsxs)("p",{children:["Avatar: ",b.image]}),Object(l.jsxs)("p",{children:["Contacts: ",b.contacts]}),Object(l.jsx)(i.b,{to:"/profile/".concat(e,"/edit"),className:"edit-button",children:"Edit"})]})}):Object(l.jsx)("div",{children:"Profile not found."})});a(52),a(53);var w=function(){return Object(l.jsx)(i.a,{children:Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)(j,{}),Object(l.jsxs)(s.d,{children:[Object(l.jsx)(s.b,{path:"/",element:Object(l.jsx)(s.a,{to:"/login",replace:!0})}),Object(l.jsx)(s.b,{path:"/login",element:Object(l.jsx)(p,{})}),Object(l.jsx)(s.b,{path:"/signup",element:Object(l.jsx)(m,{})}),Object(l.jsx)(s.b,{path:"/library",element:Object(l.jsx)(x,{})}),Object(l.jsx)(s.b,{path:"/library/:bookId",element:Object(l.jsx)(O,{})}),Object(l.jsx)(s.b,{path:"/books/upload",element:Object(l.jsx)(N,{})}),Object(l.jsx)(s.b,{path:"/profile",element:Object(l.jsx)(C,{})}),Object(l.jsx)(s.b,{path:"/profile/:id",element:Object(l.jsx)(S,{})})]})]})})},q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,56)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),o(e),r(e)}))};r.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(w,{})}),document.getElementById("root")),q()}},[[54,1,2]]]);
//# sourceMappingURL=main.e73f6a29.chunk.js.map